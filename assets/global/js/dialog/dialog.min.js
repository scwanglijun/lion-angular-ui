(function(a){"use strict";function b(b){b=a.extend(i,b||{});var d={options:b,dialog:null,init:function(){this.options.id||(this.options.id=this.getId()),this.dialog=a("#"+this.options.id),this.dialog.size()<1?(this.dialog=a(h.container),this.dialog.attr("id",this.options.id),(this.options.backdrop||"static"==this.options.backdrop)&&(this.dialog.append(h.backdrop),this.dialog.find("div.lion-modal-backdrop").css("height",a(window).height())),this.dialog.append(h.loading),this.dialog.append(h.dialogcontent),this.setHeader(),this.setContent(),this.setFooter(),a(this.options.container).append(this.dialog),console.dirxml(this.dialog),a(this.options.body).append(this.dialog),this.options.show&&mian.open()):d.open()},getId:function(){return this.options.id=g+ ++f,this.options.id},open:function(){var b=a.Event("open");this.dialog.trigger(b),b.isDefaultPrevented()||(d.loadpage(),this.dialog.show(),d.layout(),(this.options.backdrop||"static"==this.options.backdrop)&&this.dialog.find("div.lion-modal-backdrop").addClass("in"),this.dialog.attr("aria-hidden",!1))},title:function(a){this.options.closeButton&&(this.dialog.find("div.lion-modal-header>h4").before(h.closeBtn),this.dialog.find("div.lion-modal-header button.close").click(function(){d.close()})),c.isNotEmpty(this.options.title)&&this.dialog.find("div.lion-modal-header >h4").text(this.options.title),c.isNotEmpty(this.options.titleIcon)&&(this.dialog.find("div.lion-modal-header").children("i").size()<1&&this.dialog.find("div.lion-modal-header>h4").prepend(h.titleIcon),this.dialog.find("div.lion-modal-header .lion-modal-title>i").addClass(this.options.titleIcon))},setContent:function(){this.dialog.find("div.lion-modal-content").append(h.content),c.isNotEmpty(this.options.content)?(d.loading("on"),this.dialog.find("div.lion-modal-body").append(this.options.content),d.loading("off")):c.isNotEmpty(this.options.loadurl)&&d.loadpage()},loadpage:function(){d.loading("on"),this.dialog.find("div.lion-modal-body").children().remove(),this.dialog.find("div.lion-modal-body").load(this.options.loadurl,null,function(){d.loading("off")})},layout:function(){var b=this.dialog.find("div.lion-modal-dialog");if(this.options.width){this.dialog.find("div.lion-modal-dialog").css("width",this.options.width);var c=this;b.css("margin-left",function(){return/%/gi.test(c.options.width)?parseInt(c.options.width)/2+"%":(a(window).width()-c.options.width)/2+"px"})}else b.css("width",""),b.css("margin-left","");var d=this.options.height?"height":"max-height",e=this.options.height||this.options.maxHeight;this.dialog.find(".modal-body").css("overflow","").css(d,""),e&&this.dialog.find(".modal-body").css("overflow","auto").css(d,e);var f=a(window).height()-40<b.height();f||this.options.modalOverflow?b.css("margin-top",0).addClass("lion-modal-overflow"):(b.css("margin-top",40).removeClass("lion-modal-overflow"),b.css("height",this.options.height))},setHeader:function(){this.options.showHeader&&(this.dialog.find("div.lion-modal-content").append(h.header),d.title(this.options.title))},setFooter:function(){this.dialog.find("div.lion-modal-content").append(h.footer),d.setButtons()},setButtons:function(){if(null===this.options.buttons||void 0===this.options.buttons,this.options.buttons){var b="";this.dialog.find("div.lion-modal-footer").empty();var e=this;a.each(this.options.buttons,function(a,d){b+='<button  type="button" ',d.id&&(b+='id="'+d.id+'" '),b+=d.className?'class="'+d.className+'" ':"class=btn ",d.dismiss&&(b+='data-dismiss="lion-modal" '),b+=">",d.icon&&(b+='<i class="'+d.icon+'"></i>'),d.value&&(b+=d.value),b+="</button>",e.dialog.find("div.lion-modal-footer").append(b),d.headler&&c.isFunction(d.headler)&&e.dialog.find("div.lion-modal-footer").find("button:last-child").on("click",d.headler),b=""})}this.dialog.find('div.lion-modal-footer [data-dismiss="lion-modal"]').click(function(){d.close()});var f="btnalignright";"center"===this.options.btnalign?f="btnaligncenter":"left"===this.options.btnalign?f="btnalignleft":"right"===this.options.btnalign&&(f="btnalignright"),this.dialog.find("div.lion-modal-footer").addClass(f)},close:function(){this.dialog.hide()},loading:function(a){var b="";c.isEmpty(a)||"off"===a?b="none":"on"===a&&(b="block"),c.isNotEmpty(b)&&this.dialog.find("div.page-loading").css("display",b)},destroy:function(){var b=a.Event("destroy");this.dialog.trigger(b),b.isDefaultPrevented()||this.dialog.remove()},on:function(a,b){this.dialog.on(a,b)}};return d.init(),{id:function(){return d.options.id},open:function(){return d.open(),this},show:function(){return d.open(),this},title:function(a){return ain.setTitle(a),this},close:function(){return d.close(),this},loading:function(){return d.loading(),this},destory:function(){return d.destroy(),this},on:function(a,b){return d.on(a,b),this}}}this.ui=this.ui||{};var c=this.util,d=this.ui,e=this.version,f=0,g=this.namespace+"-dialog-",h={container:'<div class="lion-modal" id="ajax" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">',backdrop:'<div class="lion-modal-backdrop fade"></div>',loading:'<div class="page-loading page-loading-boxed"><img src="/admin/resources/global/img/loading-spinner-grey.gif" alt="" class="loading"><span>&nbsp;&nbsp;Loading... </span></div>',dialogcontent:'<div class="lion-modal-dialog animated"><div class="lion-modal-content"></div></div>',header:'<div class="lion-modal-header"><h4 class="lion-modal-title bule"></h4></div>',titleIcon:'<i class="fa"></i>',content:'<div class="lion-modal-body"></div>',footer:'<div class="lion-modal-footer"><button type="button" class="btn default" data-dismiss="lion-modal"> 取 消 </button><button type="button" id="btnSave" class="btn blue"> 保 存 </button></div>',closeBtn:'<button type="button" class="close" data-dismiss="lion-modal" aria-hidden="true"></button>'},i={id:"",version:e,backdrop:!0,animate:!0,keyboard:!1,className:null,closeButton:!0,show:!1,container:"body",title:"对话框",titleIcon:"",showHeader:!0,showFooter:!0,loadurl:"",content:"",btnalign:"center",width:.95*a("body").width()+"px",height:"auto",maxHeight:"80%",position:{top:"35%",left:"50%"}};d.dialog=function(a){return new b(a)}}).call(lion,jQuery);